# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç NS.apk

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**NS.apk** (Navistart) - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-–ª–∞—É–Ω—á–µ—Ä, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
1. **–ó–∞–ø—É—Å–∫–∞—Ç—å –ª—é–±–æ–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –ø–æ –µ–≥–æ package name
2. **–ó–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Ç–æ—Ä–æ–º –¥–∏—Å–ø–ª–µ–µ** (–¥–ª—è –ø—Ä–æ–µ–∫—Ü–∏–∏ –Ω–∞ –ø—Ä–∏–±–æ—Ä–Ω—É—é –ø–∞–Ω–µ–ª—å/HUD)
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã
4. **–†–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** —á–µ—Ä–µ–∑ Broadcast Receiver

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

```
NS.apk
‚îú‚îÄ‚îÄ MainActivity          # UI –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ boot (Service)        # Foreground Service –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ GoNavi                # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ MyReceiver            # Broadcast Receiver –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
‚îî‚îÄ‚îÄ SystemMessageReceiver # Receiver –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
```

---

## üì± MainActivity - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:

1. **–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç UI** —Å –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ package name
2. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –≤ SharedPreferences
3. **–ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å** –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
4. **–ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:

```java
public class MainActivity extends AppCompatActivity {
    SharedPreferences settings;
    
    @Override
    public void onCreate(Bundle savedInstanceState) {
        // –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π package name (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "ru.yandex.yandexmaps")
        textin.setText(loadText("pkg", this.settings));
        
        // –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 1
        button.setOnClickListener(v -> {
            saveText("pkg", textin.getText().toString(), settings);
            staboot(1, getApplicationContext()); // –ó–∞–ø—É—Å–∫ –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 1
        });
        
        // –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 0
        button2.setOnClickListener(v -> {
            saveText("pkg", textin.getText().toString(), settings);
            staboot(0, getApplicationContext()); // –ó–∞–ø—É—Å–∫ –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 0
        });
    }
}
```

### –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```java
private void DispMap(View v, int d, String pkg) {
    // 1. –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–∏—Å–ø–ª–µ–µ–≤
    DisplayManager displayManager = (DisplayManager) getSystemService("display");
    Display[] dis = displayManager.getDisplays();
    
    // 2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –¥–∏—Å–ø–ª–µ—è
    if (dis.length > 1) {
        // 3. –ü–æ–ª—É—á–∞–µ—Ç Intent –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        Intent i = getPackageManager().getLaunchIntentForPackage(pkg);
        
        if (i != null) {
            // 4. –°–æ–∑–¥–∞–µ—Ç –æ–ø—Ü–∏–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ
            ActivityOptions options = ActivityOptions.makeBasic()
                .setLaunchDisplayId(dis[d].getDisplayId());
            
            // 5. –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            startActivity(i, options.toBundle());
        }
    }
}
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- `getLaunchIntentForPackage(pkg)` - –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Intent –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `ActivityOptions.setLaunchDisplayId()` - —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–∞–∫–æ–º –¥–∏—Å–ø–ª–µ–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å
- `startActivity()` - –∑–∞–ø—É—Å–∫–∞–µ—Ç Activity

---

## üîÑ boot.java - Foreground Service (–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫)

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:

1. **–†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ** –ø–æ—Å—Ç–æ—è–Ω–Ω–æ (Foreground Service)
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
3. **–°–ª—É—à–∞–µ—Ç Broadcast —Å–æ–±—ã—Ç–∏—è** –æ—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è
4. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª:

```java
public class boot extends Service {
    
    @Override
    public void onCreate() {
        // 1. –°–æ–∑–¥–∞–µ—Ç Notification Channel (–¥–ª—è Foreground Service)
        NotificationChannel channel = new NotificationChannel(
            "NaviStartService", "Background", 3
        );
        
        // 2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç Broadcast Receiver
        this.receiver = new MyReceiver();
        registerReceiver(this.receiver, 
            new IntentFilter("desay.broadcast.map.meter.interaction"));
        
        // 3. –ó–∞–ø—É—Å–∫–∞–µ—Ç Foreground Service
        startForeground(1, builder.build());
    }
    
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        // 1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç package name –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        this.settings = getSharedPreferences("pkg", 0);
        String pkg = loadText("pkg", settings); // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: "ru.yandex.yandexmaps"
        
        // 2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ping –≤ —Å–∏—Å—Ç–µ–º—É
        ping();
        
        // 3. –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–º–µ—Ä –¥–∏—Å–ø–ª–µ—è –∏–∑ Intent
        int displayId = intent.getIntExtra("d", -1);
        
        // 4. –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ
        if (displayId > -1) {
            DispMap(null, displayId, pkg);
        }
        
        return START_STICKY; // –°–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
    }
}
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

1. **Foreground Service:**
   - –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤ —Ñ–æ–Ω–µ
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ Android)
   - –ù–µ —É–±–∏–≤–∞–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π

2. **Broadcast Receiver:**
   ```java
   registerReceiver(receiver, 
       new IntentFilter("desay.broadcast.map.meter.interaction"));
   ```
   - –°–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è
   - –ú–æ–∂–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—É—Å–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏)

3. **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:**
   - –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
   - –ß–∏—Ç–∞–µ—Ç package name –∏–∑ SharedPreferences
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ

4. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
   ```java
   void ping() {
       Intent intent = new Intent("turbodog.navigation.system.message");
       intent.putExtra("CODE", 207);
       intent.putExtra("DATA", 0);
       sendBroadcast(intent);
   }
   ```
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É
   - –ö–æ–¥ 207 - –≤–æ–∑–º–æ–∂–Ω–æ, —Å–∏–≥–Ω–∞–ª –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

---

## üì° GoNavi.java - –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è.

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π:

```java
public class GoNavi {
    // Action –¥–ª—è Broadcast Intent
    public static final String SEND_SYSTEM_MESSAGE = "turbodog.navigation.system.message";
    
    // –ü–æ–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
    public static final String MESSAGE_CODE = "CODE";
    public static final String MESSAGE_DATA = "DATA";
    public static final String MESSAGE_TURN_TYPE = "TURN_TYPE";      // –¢–∏–ø –ø–æ–≤–æ—Ä–æ—Ç–∞
    public static final String MESSAGE_TURN_DIST = "TURN_DIST";     // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–æ—Ä–æ—Ç–∞
    public static final String MESSAGE_TURN_TIME = "TURN_TIME";     // –í—Ä–µ–º—è –¥–æ –ø–æ–≤–æ—Ä–æ—Ç–∞
    public static final String MESSAGE_REMAINING_DIST = "REMAINING_DIST"; // –û—Å—Ç–∞–≤—à–µ–µ—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
    public static final String MESSAGE_REMAINING_TIME = "REMAINING_TIME"; // –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
    public static final String MESSAGE_ARRIVE_TIME = "ARRIVE_TIME"; // –í—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è
    public static final String MESSAGE_CURRENT_ROAD = "CURRENT_ROAD"; // –¢–µ–∫—É—â–∞—è –¥–æ—Ä–æ–≥–∞
    public static final String MESSAGE_NEXT_ROAD = "NEXT_ROAD";     // –°–ª–µ–¥—É—é—â–∞—è –¥–æ—Ä–æ–≥–∞
}
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

```java
// –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–≤–æ—Ä–æ—Ç–µ
Intent intent = new Intent("turbodog.navigation.system.message");
intent.putExtra("CODE", 200);              // –ö–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è
intent.putExtra("TURN_TYPE", 1);            // –¢–∏–ø –ø–æ–≤–æ—Ä–æ—Ç–∞ (1 = –Ω–∞–ø—Ä–∞–≤–æ)
intent.putExtra("TURN_DIST", 500);          // 500 –º–µ—Ç—Ä–æ–≤ –¥–æ –ø–æ–≤–æ—Ä–æ—Ç–∞
intent.putExtra("TURN_TIME", 30);           // 30 —Å–µ–∫—É–Ω–¥ –¥–æ –ø–æ–≤–æ—Ä–æ—Ç–∞
intent.putExtra("REMAINING_DIST", 5000);     // 5 –∫–º –¥–æ —Ü–µ–ª–∏
intent.putExtra("REMAINING_TIME", 300);      // 5 –º–∏–Ω—É—Ç –¥–æ —Ü–µ–ª–∏
sendBroadcast(intent);
```

**–í–∞–∂–Ω–æ:** –≠—Ç–æ —Ñ–æ—Ä–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TurboDog –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–∏–±–æ—Ä–Ω—É—é –ø–∞–Ω–µ–ª—å!

---

## üîî MyReceiver - Broadcast Receiver

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–°–ª—É—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –º–æ–∂–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –æ—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è.

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:

```java
// –í boot.java
registerReceiver(this.receiver, 
    new IntentFilter("desay.broadcast.map.meter.interaction"));
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π:

```java
public class MyReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        Bundle bundle = intent.getExtras();
        if (bundle != null) {
            int map_area = bundle.getInt("map_area");
            
            // map_area = 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 1 (–ø—Ä–∏–±–æ—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å)
            if (map_area == 1) {
                staboot(1, context);
            }
            
            // map_area = 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 0 (–æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω)
            if (map_area == 2 && this.boot) {
                staboot(0, context);
            }
        }
    }
}
```

**–°–æ–±—ã—Ç–∏—è –æ—Ç —Å–∏—Å—Ç–µ–º—ã:**
- `"desay.broadcast.map.meter.interaction"` - –∫–æ–º–∞–Ω–¥—ã –æ—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è
- `map_area = 1` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–∞ –ø—Ä–∏–±–æ—Ä–Ω–æ–π –ø–∞–Ω–µ–ª–∏
- `map_area = 2` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
- –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—É—Å–∫–æ–º –Ω–∞–≤–∏–≥–∞—Ü–∏–∏!

---

## üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã

### 1. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞):

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç NS.apk
    ‚Üì
–û—Ç–∫—Ä—ã–≤–∞–µ—Ç MainActivity
    ‚Üì
–í–≤–æ–¥–∏—Ç package name (–Ω–∞–ø—Ä–∏–º–µ—Ä: "ru.yandex.yandexnavi")
    ‚Üì
–ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –∑–∞–ø—É—Å–∫–∞
    ‚Üì
MainActivity —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç package name –≤ SharedPreferences
    ‚Üì
MainActivity –∑–∞–ø—É—Å–∫–∞–µ—Ç boot Service
    ‚Üì
boot Service –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ
```

### 2. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã:

```
–°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
    ‚Üì
boot Service –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (RECEIVE_BOOT_COMPLETED)
    ‚Üì
boot.onCreate() - —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç Broadcast Receiver
    ‚Üì
boot.onStartCommand() - –∑–∞–≥—Ä—É–∂–∞–µ—Ç package name –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    ‚Üì
boot.DispMap() - –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ
    ‚Üì
boot.ping() - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
```

### 3. –†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:

```
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Broadcast
    ‚Üì
Intent: "desay.broadcast.map.meter.interaction"
    Extra: "map_area" = 1 –∏–ª–∏ 2
    ‚Üì
MyReceiver –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ
    ‚Üì
MyReceiver.onReceive() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç map_area:
    - map_area = 1 ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 1 (–ø—Ä–∏–±–æ—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å)
    - map_area = 2 ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–∞ –¥–∏—Å–ø–ª–µ–µ 0 (–æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω)
    ‚Üì
–í—ã–∑—ã–≤–∞–µ—Ç staboot(displayId, context)
    ‚Üì
boot Service –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–ø–ª–µ–µ
```

**–í–∞–∂–Ω–æ:** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Broadcast Intent!

### 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

```
NS.apk (–∏–ª–∏ –¥—Ä—É–≥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ) —Ö–æ—á–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
    ‚Üì
–°–æ–∑–¥–∞–µ—Ç Intent —Å action "turbodog.navigation.system.message"
    ‚Üì
–î–æ–±–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ (TURN_TYPE, TURN_DIST, –∏ —Ç.–¥.)
    ‚Üì
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ sendBroadcast()
    ‚Üì
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
    ‚Üì
–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–∞ –ø—Ä–∏–±–æ—Ä–Ω–æ–π –ø–∞–Ω–µ–ª–∏/HUD
```

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã

### 1. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Ç–æ—Ä–æ–º –¥–∏—Å–ø–ª–µ–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–±–æ—Ä–Ω–æ–π –ø–∞–Ω–µ–ª–∏/HUD?

**–†–µ—à–µ–Ω–∏–µ:**
```java
DisplayManager displayManager = getSystemService("display");
Display[] displays = displayManager.getDisplays();

if (displays.length > 1) {
    Intent intent = getPackageManager().getLaunchIntentForPackage(packageName);
    ActivityOptions options = ActivityOptions.makeBasic()
        .setLaunchDisplayId(displays[1].getDisplayId()); // –í—Ç–æ—Ä–æ–π –¥–∏—Å–ø–ª–µ–π
    startActivity(intent, options.toBundle());
}
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- Android –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∏—Å–ø–ª–µ–µ–≤
- –ü–µ—Ä–≤—ã–π –¥–∏—Å–ø–ª–µ–π (0) - –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
- –í—Ç–æ—Ä–æ–π –¥–∏—Å–ø–ª–µ–π (1) - –ø—Ä–∏–±–æ—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å/HUD
- `setLaunchDisplayId()` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–∞–∫–æ–π –¥–∏—Å–ø–ª–µ–π –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 2. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Foreground Service

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ?

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Foreground Service
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å `RECEIVE_BOOT_COMPLETED` –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –°–µ—Ä–≤–∏—Å —á–∏—Ç–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 3. –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —á–µ—Ä–µ–∑ Broadcast

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∫ –æ–±—â–∞—Ç—å—Å—è —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è?

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Broadcast Intent
- –°–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏—è: `"desay.broadcast.map.meter.interaction"`
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ: `"turbodog.navigation.system.message"`
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è

---

## üéØ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### –ß—Ç–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

1. **–ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getLaunchIntentForPackage()` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ø–Ω–¥–µ–∫—Å –ù–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
   - –ó–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ –≤—Ç–æ—Ä–æ–º –¥–∏—Å–ø–ª–µ–µ –¥–ª—è –ø—Ä–æ–µ–∫—Ü–∏–∏

2. **Foreground Service:**
   - –°–æ–∑–¥–∞—Ç—å Bridge Service –Ω–∞ –æ—Å–Ω–æ–≤–µ boot.java
   - –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –Ø–Ω–¥–µ–∫—Å –ù–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

3. **Broadcast Intent:**
   - –°–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –æ—Ç –Ø–Ω–¥–µ–∫—Å –ù–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ `"turbodog.navigation.system.message"`
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è

4. **–§–æ—Ä–º–∞—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –∏–∑ GoNavi.java
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å TURN_TYPE, TURN_DIST, –∏ —Ç.–¥.
   - –°–∏—Å—Ç–µ–º–∞ —É–∂–µ –∑–Ω–∞–µ—Ç —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç!

---

## üìù –í—ã–≤–æ–¥—ã

**NS.apk - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ª–∞—É–Ω—á–µ—Ä:**

1. ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Android API
2. ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª—é–±–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –†–∞–±–æ—Ç–∞–µ—Ç —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è —á–µ—Ä–µ–∑ Broadcast
4. ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** Foreground Service –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É

**–î–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:**
- –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–∞—è –æ—Å–Ω–æ–≤–∞ –¥–ª—è Bridge Service
- –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞–ø—É—Å–∫–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –§–æ—Ä–º–∞—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π –∏–∑–≤–µ—Å—Ç–µ–Ω
- –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

---

**–î–∞—Ç–∞:** 2024  
**–í–µ—Ä—Å–∏—è:** 1.0

