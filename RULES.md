# ПРАВИЛА ПРОЕКТА И УНИВЕРСАЛЬНЫЙ ПРОМПТ ДЛЯ АГЕНТОВ

> **Важно:** Эти правила обязательны для всех участников проекта, включая AI‑агентов.
> Любое действие в репозитории должно в первую очередь соблюдать структуру директорий и полноту анализа документации.

---

## 1. БАЗОВАЯ СТРУКТУРА РЕПОЗИТОРИЯ

- **`Documentation/`** — единая библиотека знаний (все `.md`, аналитика, планы, инструкции, статусы).
  - Любые новые знания, планы, отчёты, статусы, инструкции → **только сюда**, с обновлением `00_README.md` и `СТРУКТУРА.md`, если меняется структура.
- **`Scripts/`** — все исполняемые скрипты и вспомогательные утилиты (sh/py и т.п.), сгруппированные по назначению:
  - `Scripts/qnx/` — всё по QNX и удалённому доступу
  - `Scripts/android/` — всё по Android/эмуляторам/лаунчеру
  - `Scripts/emulator/` — управление эмулятором T18FL3
  - `Scripts/remote_tunnel/` — сборка/установка RemoteTunnel
- **`Development/`** — папка для НОВОГО кода (проекты, которые пишутся с нуля).
- **`APK_Library/`** — единая библиотека APK:
  - `01_System_Apps_Chery/`
  - `02_Third_Party_Apps/`
  - `04_From_Update/`
  - `05_Temporary/`
  - При добавлении APK — обновлять `APK_Library/README.md`.
- **`firmware/`** — исходные прошивки и OTA‑пакеты (то, из чего пересобираются образы; не трогаем без особой необходимости).
- **`Utilities/`** — при необходимости исходники/скрипты установленных утилит (homebrew‑инструменты, вспомогательные CLI и т.п.) с отдельным README.
- **Корень репозитория:**
  - `Documentation/`, `Scripts/`, `Development/`, `APK_Library/`, `firmware/`, `Utilities/` (опционально), `RULES.md`, `.gitignore`.

---

## 2. ПРАВИЛА ДЛЯ ДОКУМЕНТАЦИИ (`Documentation/`)

- **Все `.md` → только в `Documentation/`**:
  - планы, статусы, аналитика, отчёты, quick‑start, troubleshooting, TODO, идеи.
- При добавлении/изменении документов:
  - Обновить локальные `README.md` в подпапках.
  - При изменении структуры разделов — обновить `Documentation/СТРУКТУРА.md`.
  - Если создаётся новый глобальный план → добавить ссылку в `Documentation/00_README.md`.
- **Планы и роадмапы:**
  - Глобальные планы проекта вести в разделе `Documentation/03_ПЛАНЫ/`.
  - Этапы по проекту (эмулятор, root‑образ, кастомизация, установка финального образа) должны быть зафиксированы как единый сценарий в отдельном файле‑плане.

---

## 3. ПРАВИЛА ДЛЯ СКРИПТОВ (`Scripts/`)

- Любой исполняемый скрипт (sh/py/etc.), который:
  - автоматизирует действия,
  - используется агентом,
  - заменяет ручной ввод команд,
    → должен находиться в `Scripts/` и быть разложен по смысловым подпапкам.
- Требования к скриптам:
  - Самодостаточность (минимум неявных зависимостей).
  - Краткий header‑комментарий: назначение, предпосылки, пример запуска.
  - Если скрипт завязан на конкретные пути — они должны быть либо:
    - относительными от корня репозитория, либо
    - сконфигурированы через переменные окружения.

---

## 4. ВРЕМЕННЫЕ ФАЙЛЫ И МУСОР

- Всё временное, кеши, сгенерированные артефакты, образы для экспериментов:
  - **не хранятся** в репозитории, если не несут уникальной ценности.
  - образы систем и распакованные OTA в `Documentation/` → удаляются после фиксации результата в документации, кроме исходных OTA/прошивок, которые перемещаются в `firmware/`.
- При появлении временных директорий (`tmp/`, `.gradle/`, кэши инструментов и т.п.) — добавлять их в `.gitignore` и периодически очищать локально.

---

## 5. .gitignore И БЕЗОПАСНОСТЬ

- Всё, что содержит секреты или персональные данные, **обязательно** должно быть в `.gitignore`:
  - API‑ключи, токены, пароли, файлы конфигураций с секретами.
  - Логи с чувствительной информацией (кроме тех, что явно нужны как артефакты анализа).
- Примеры для игнора:
  - `*_api_key.txt`, `*.key`, `*.token`
  - `config/personal_*.json`
  - `.env`, `.env.*`
  - временные/кеш‑директории инструментов (`.gradle/`, `.idea/`, `tmp/` и т.п.).

---

## 6. GIT‑ПРОЦЕСС (КРАТКО)

- **Никаких автоматических push/merge без явного разрешения пользователя.**
- Коммиты:
  - Должны быть логически завершёнными.
  - Должны отражать осмысленные изменения (структура, новая фича, крупная чистка).
- Merge:
  - Только после явного подтверждения пользователя (через PR или прямой запрос).

---

## 7. ОГРАНИЧЕНИЯ СРЕДЫ РАЗРАБОТКИ

- Весь код и вся работа по проекту выполняются **внутри Cursor/этой среды**:
  - Нельзя перекладывать шаги на пользователя (создание проектов, правки кода, настройка IDE) — агент делает это сам средствами доступных утилит.
  - Если какой‑то стек (например, Swift/SwiftUI) **невозможен** для сборки/запуска в текущей среде, агент обязан:
    - Явно зафиксировать это в документации (`Documentation/09_ЭМУЛЯТОР` или профильный раздел).
    - Предложить и реализовать альтернативу (веб‑интерфейс, другой язык/фреймворк), не требующую ручных действий пользователя вне репозитория.
- Дополнительные утилиты (homebrew, инструменты для QEMU/Android/QNX и т.п.):
  - Можно устанавливать и использовать только если это согласуется с политикой окружения.
  - Исходники/скрипты установленных утилит (если мы их кладём в репозиторий) должны храниться в отдельной папке `Utilities/` с README по использованию.

---

## 8. УНИВЕРСАЛЬНЫЙ ПРОМПТ ДЛЯ AI‑АГЕНТОВ

**Этот раздел — обязательный контекст для любого агента, работающего с репозиторием (дополняет все правила выше).**

1. **Приоритет №1 — структура и порядок:**

   - Всегда сначала проверить и сохранить консистентность структуры директорий:
     - Документация → только в `Documentation/`
     - Скрипты → только в `Scripts/`
     - APK → только в `APK_Library/`
     - Прошивки/OTA → в `firmware/`
   - Любые новые файлы раскладывать по смыслу, а не "куда ближе".

2. **Приоритет №2 — полный анализ документации перед действием:**

   - Перед реализацией фичи, изменением структуры, удалением данных или образов:
     - Пройти по релевантным разделам `Documentation/` (контекст, анализы, планы, инструкции, QNX/T18FL3/Эмулятор/Разработка).
     - Если по теме есть план или статус — сначала свериться с ним.
   - Нельзя "придумывать" решения, игнорируя уже написанные документы.

3. **Удаление и перенос файлов:**

   - Если файл кажется устаревшим/мусорным, но несёт редкую или трудно воспроизводимую информацию (оригинальные прошивки, редкие логи, старый код) → переносить в подходящий "холодный" раздел (например, `firmware/` для прошивок) и фиксировать в описании изменений.
   - Безвозвратное удаление допустимо только для:
     - кэшей, временных файлов, легко восстанавливаемых артефактов;
     - дублей образов, которые можно заново собрать из OTA/прошивки;
     - заведомо пустых или тестовых файлов без ценности.

4. **Работа со скриптами:**

   - Любой новый скрипт:
     - размещать в `Scripts/…` в подходящей подпапке;
     - описывать в соответствующей документации (README или профильном .md).
   - Скрипты должны быть удобны для запуска как человеком, так и агентом.

5. **Коммуникация с пользователем:**

   - При изменении глобальной структуры или правил — кратко описывать суть изменений.

---

**Последнее обновление:** 2025‑11‑27  
**Ответственный за структуру:** владелец репозитория (Валентин); AI‑агенты обязаны строго следовать этим правилам.
