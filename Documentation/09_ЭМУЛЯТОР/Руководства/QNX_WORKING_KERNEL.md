# QNX в режиме с рабочим ядром

## Краткий ответ

**QNX может не запуститься** в режиме с рабочим ядром, потому что:

1. **QNX требует специфичную конфигурацию оборудования** - QNX обычно загружается через свой собственный загрузчик и требует специфичные адреса памяти и устройства
2. **Стандартная virt машина может не поддерживать все требования QNX** - QNX может требовать специфичные устройства, которых нет в стандартной virt машине
3. **QNX образы монтируются как диски, но QNX не загружается автоматически** - QNX требует своего загрузчика и процесса инициализации

## Что происходит

В режиме с рабочим ядром:

- ✅ QNX образы (`qnx_boot.img`, `qnx_system.img`) **монтируются как виртуальные диски**
- ✅ Диски доступны в QEMU
- ❌ **QNX не загружается автоматически** - нужен специальный загрузчик
- ❌ **QNX может не работать** со стандартной virt машиной

## Решения

### Вариант 1: Тестировать только Android (рекомендуется для начала)

Для тестирования приложений Android достаточно только Android системы:

```bash
# В GUI: отключите QNX чекбокс
# Или через переменную окружения:
export T18FL3_ANDROID_ONLY=1
export T18FL3_USE_WORKING_KERNEL=1
python3 main.py
```

**Преимущества:**

- Быстрый запуск
- Стабильная работа
- Фокус на Android приложениях

### Вариант 2: Использовать оригинальное ядро для QNX

Если нужен QNX, используйте оригинальное ядро (когда оно будет работать):

```bash
# Отключите режим рабочего ядра
unset T18FL3_USE_WORKING_KERNEL
python3 main.py
```

**Преимущества:**

- Полная поддержка QNX
- Максимально точная эмуляция

**Недостатки:**

- Требует исправления проблем с оригинальным ядром

### Вариант 3: Запустить QNX отдельно (если нужно)

Если критически нужен QNX для тестирования:

1. Запустите Android в режиме с рабочим ядром
2. Запустите QNX в отдельном QEMU инстансе
3. Настройте сетевую связь между ними

Это сложнее, но может работать для тестирования взаимодействия Android-QNX.

## Рекомендация

**Для тестирования модифицированных приложений:**

1. **Начните с Android-only режима** - этого достаточно для тестирования большинства приложений
2. **QNX обычно используется для:**
   - Низкоуровневых системных функций
   - CAN-шины (но у вас есть CAN симулятор)
   - Специфичных автомобильных функций
3. **Если приложение не зависит от QNX** - тестируйте без него
4. **Если нужен QNX** - исправьте оригинальное ядро или используйте отдельный инстанс

## Проверка зависимости от QNX

Чтобы понять, нужен ли QNX для вашего приложения:

1. **Проверьте логи приложения** - есть ли ошибки связанные с QNX?
2. **Проверьте зависимости** - использует ли приложение QNX сервисы?
3. **Проверьте broadcast** - отправляет ли приложение сообщения в QNX?

Если приложение работает без QNX - можно тестировать в Android-only режиме.

## Текущая реализация

В режиме с рабочим ядром:

- QNX образы монтируются как диски (если `enable_qnx=True`)
- Но QNX не загружается автоматически
- QNX требует своего загрузчика и процесса инициализации

## Вывод

**Для быстрого тестирования приложений:**

- ✅ Используйте Android-only режим с рабочим ядром
- ✅ Это позволит тестировать большинство приложений
- ✅ QNX можно добавить позже, когда будет нужно

**Если критически нужен QNX:**

- Исправьте оригинальное ядро
- Или используйте отдельный QEMU инстанс для QNX

