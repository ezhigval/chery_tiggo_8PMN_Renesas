# Архитектура двух экранов в Chery Tiggo 8 Pro Max

## Обнаруженная архитектура

### Display 0: Встроенный экран (Android Head Unit)
- **Тип**: BUILT_IN (встроенный)
- **Разрешение**: 1920 x 720
- **DPI**: 160 (243.84 x 182.88 dpi)
- **Состояние**: ON
- **Флаги**: FLAG_DEFAULT_DISPLAY, FLAG_ROTATES_WITH_CONTENT, FLAG_SECURE, FLAG_SUPPORTS_PROTECTED_BUFFERS
- **Назначение**: Головное устройство (Android), где работают все приложения

### Display 1: Экран HDMI (QNX Instrument Cluster)
- **Тип**: HDMI (внешний)
- **Разрешение**: 1920 x 720
- **DPI**: 213 (213.0 x 213.0 dpi)
- **Состояние**: ON
- **Флаги**: FLAG_SECURE, FLAG_SUPPORTS_PROTECTED_BUFFERS, **FLAG_PRESENTATION**
- **Назначение**: Приборная панель (QNX), где отображается навигация

## Важные наблюдения

1. **FLAG_PRESENTATION** на Display 1 означает, что это презентационный дисплей (вторичный экран)
2. Оба экрана имеют одинаковое разрешение 1920x720
3. Display 1 имеет более высокую плотность пикселей (213 vs 160)
4. Display 1 помечен как `mHasContent=false`, что может означать, что контент передается через другой механизм

## Применимость для нашего проекта

### ✅ Применимо:
1. **Broadcast Intent** - наш основной механизм отправки данных (`turbodog.navigation.system.message`)
   - Broadcast Intent'ы работают на уровне системы Android, независимо от дисплеев
   - QNX система на Display 1 должна получать эти Broadcast'ы через системный мост

2. **Формат данных** - мы используем тот же формат, что и TurboDog:
   - `CODE = 201` (TURNBYTURN_CODE)
   - Те же поля: `TURN_TYPE`, `TURN_DIST`, `TURN_TIME`, `REMAINING_DIST`, `REMAINING_TIME`, `ARRIVE_TIME`, `CURRENT_ROAD`, `NEXT_ROAD`

### ⚠️ Требует проверки:
1. **Механизм передачи** - как именно QNX получает Broadcast Intent'ы от Android?
   - Возможно, есть системный сервис-мост между Android и QNX
   - Нужно проверить, кто слушает `turbodog.navigation.system.message`

2. **Display ID** - нужно ли указывать Display ID при отправке?
   - Скорее всего нет, так как Broadcast Intent'ы системные
   - Но стоит проверить, не требуется ли дополнительная настройка

3. **Приоритет данных** - если запущен TurboDog, он тоже отправляет данные
   - Нужно убедиться, что наши данные не конфликтуют
   - Возможно, нужно отключать TurboDog или использовать другой механизм

## Выводы

1. **Архитектура двух экранов не влияет напрямую на наш код** - мы отправляем Broadcast Intent'ы, которые обрабатываются на системном уровне
2. **Важно проверить**, кто именно слушает `turbodog.navigation.system.message` и как данные передаются в QNX
3. **Текущий подход корректен** - мы используем тот же механизм, что и TurboDog

## Следующие шаги

1. Проверить, кто слушает Broadcast `turbodog.navigation.system.message`
2. Убедиться, что NotificationListenerService перехватывает уведомления от Yandex Maps
3. Проверить, доходят ли наши Broadcast'ы до QNX системы

