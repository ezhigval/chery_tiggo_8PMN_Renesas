# Альтернативные методы получения данных навигации

## Текущая ситуация

NotificationListenerService включается через ADB, но:
- Настройка может сбрасываться
- NavigationNotificationListener не создается автоматически
- Возможно, требуется перезагрузка системы

## Альтернативные методы

### 1. YandexNavigatorDataExtractor (Reflection)

**Статус**: Реализован, но требует:
- Запущенный Yandex Maps
- Активную навигацию (построенный маршрут)
- Доступ к `NotificationDataManager` через reflection

**Преимущества**:
- Не требует системных разрешений
- Работает напрямую с навигатором
- Получает данные из `NotificationDataManager`

**Недостатки**:
- Зависит от внутренней структуры Yandex Maps
- Может сломаться при обновлении навигатора
- Требует запущенную навигацию

### 2. NotificationListenerService

**Статус**: Реализован, но не активируется автоматически

**Преимущества**:
- Официальный Android API
- Не зависит от внутренней структуры навигатора
- Работает с любыми уведомлениями

**Недостатки**:
- Требует ручного включения в настройках
- Может не активироваться автоматически
- Настройка может сбрасываться

### 3. AccessibilityService

**Статус**: Реализован (`NavigationAccessibilityService`)

**Преимущества**:
- Может читать UI элементы
- Получает данные напрямую из интерфейса

**Недостатки**:
- Требует включения в настройках
- Менее надежен, чем другие методы
- Зависит от структуры UI

## Рекомендации

1. **Использовать комбинацию методов**:
   - Основной: `YandexNavigatorDataExtractor` (reflection)
   - Резервный: `NotificationListenerService` (если активируется)
   - Дополнительный: `AccessibilityService` (если другие не работают)

2. **Для активации NotificationListenerService**:
   - Включить через ADB: `adb shell settings put secure enabled_notification_listeners com.desaysv.tiggo.bridge/.notification.NavigationNotificationListener`
   - Перезагрузить систему
   - Проверить логи на создание `NavigationNotificationListener`

3. **Мониторинг**:
   - Проверять логи всех трех методов
   - Использовать тот, который работает
   - Fallback на другие методы при сбоях

## Текущий приоритет

1. **YandexNavigatorDataExtractor** - основной метод (reflection)
2. **NotificationListenerService** - резервный (если активируется)
3. **AccessibilityService** - дополнительный (если другие не работают)

