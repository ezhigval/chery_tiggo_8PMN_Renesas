# –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞ Tiggo Bridge Service

## –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞-–º–æ—Å—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (Yandex Navigator, 2GIS, TurboDog) –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Ö –≤ —à—Ç–∞—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ø—Ä–∏–±–æ—Ä–Ω–æ–π –ø–∞–Ω–µ–ª–∏.

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞)

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `TiggoBridgeService`
2. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `BridgeService` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
3. ‚úÖ –ü–æ–ø—ã—Ç–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Reflection (–Ω–µ—É–¥–∞—á–Ω–æ)
4. ‚úÖ –ü–æ–ø—ã—Ç–∫–∏ —á–µ—Ä–µ–∑ AccessibilityService (–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –≤ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ)
5. ‚úÖ –°–æ–∑–¥–∞–Ω `NavigationDataInterceptor` –¥–ª—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
6. ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω—ã APK —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (TurboDog, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
7. üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ APK –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è:

#### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- `NavigationData` –∫–ª–∞—Å—Å —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - `remainingDistance` (Double) - –æ—Å—Ç–∞–≤—à–µ–µ—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
  - `maneuverDistance` (Double) - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –º–∞–Ω–µ–≤—Ä–∞
  - `maneuverType` (String) - —Ç–∏–ø –º–∞–Ω–µ–≤—Ä–∞
  - `speedLimit` (Integer) - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
  - `currentRoad` / `nextRoad` (String) - –Ω–∞–∑–≤–∞–Ω–∏—è –¥–æ—Ä–æ–≥
  - `currentLat` / `currentLon` (Double) - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
  - `travelTime` / `remainingTime` (Integer) - –≤—Ä–µ–º—è –≤ –ø—É—Ç–∏
  - `arriveTime` (String) - –≤—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è

#### 2. –ú–µ—Ç–æ–¥—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
- **Reflection**: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å `Guidance` –∏–∑ `GenericGuidanceComponent` (–Ω–µ—É–¥–∞—á–Ω–æ - –ø–æ–ª—è null)
- **AccessibilityService**: UI-based –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ (–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ - –Ω–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Å–∏—Å—Ç–µ–º–µ)
- **BroadcastReceiver**: –ü–µ—Ä–µ—Ö–≤–∞—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö broadcast'–æ–≤ –æ—Ç –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
- **ContentProvider**: (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **SharedPreferences**: (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **File Monitoring**: (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

#### 3. –ö–ª—é—á–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã
- `com.astrob.turbodog` - —à—Ç–∞—Ç–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è TurboDog
- `ru.yandex.yandexnavi` - Yandex Navigator
- `com.desaysv.tiggo.bridge` - –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#### 4. Broadcast Actions
- `turbodog.navigation.system.message` - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π broadcast –æ—Ç TurboDog
- `ru.yandex.yandexnavi.NAVIGATION_STARTED` - –∑–∞–ø—É—Å–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- `ru.yandex.yandexnavi.MANEUVER_UPDATED` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–Ω–µ–≤—Ä–∞
- –ò –¥—Ä—É–≥–∏–µ...

### –ü—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
1. ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å `Guidance` —á–µ—Ä–µ–∑ Reflection (–ø–æ–ª—è `handler` –∏ `consumer` –≤ `GenericGuidanceImpl` —Ä–∞–≤–Ω—ã null)
2. ‚ùå AccessibilityService –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–Ω–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ Android –≤ —Å–∏—Å—Ç–µ–º–µ)
3. ‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, –∫–∞–∫–∏–µ broadcast'—ã —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Yandex Navigator
4. ‚ö†Ô∏è TurboDog –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç—ã–µ API

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ó–∞–≤–µ—Ä—à–∏—Ç—å –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—é APK
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ TurboDog –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è:
   - –ö–∞–∫–∏–µ broadcast'—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
   - –ö–∞–∫–∏–µ ContentProvider'—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
   - –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
development/
‚îú‚îÄ‚îÄ projects/
‚îÇ   ‚îî‚îÄ‚îÄ TiggoBridgeService/          # –û—Å–Ω–æ–≤–Ω–æ–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ app/src/main/java/com/desaysv/tiggo/bridge/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BridgeService.java        # –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ConfigManager.java        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Constants.java            # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ navigation/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NavigationData.java       # –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NavigationMonitor.java    # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NavigationDataInterceptor.java  # –ü–µ—Ä–µ—Ö–≤–∞—Ç –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ReflectionHelper.java     # Reflection-–ø–æ–¥—Ö–æ–¥
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DataExtractor.java        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SystemSender.java         # –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ —Å–∏—Å—Ç–µ–º—É
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ StatusBarRenderer.java    # –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–∞
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ui/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ DashboardActivity.java    # –ì–ª–∞–≤–Ω—ã–π UI
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ StatusFragment.java       # –§—Ä–∞–≥–º–µ–Ω—Ç —Å—Ç–∞—Ç—É—Å–∞
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ extracted_from_device/            # –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ APK
‚îÇ   ‚îú‚îÄ‚îÄ *.apk                         # APK —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ decompiled/                   # –î–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ scripts/                          # –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ extract_apks_from_device.ps1
‚îÇ   ‚îú‚îÄ‚îÄ extract_apks_from_device.sh
‚îÇ   ‚îú‚îÄ‚îÄ decompile_apks.ps1
‚îÇ   ‚îî‚îÄ‚îÄ extract_images_from_apk.ps1
‚îî‚îÄ‚îÄ screenshots/                      # –°–∫—Ä–∏–Ω—à–æ—Ç—ã UI
    ‚îî‚îÄ‚îÄ system_ui/
```

## –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

### –î–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ APK (–ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏):
1. `com.astrob.turbodog` - —à—Ç–∞—Ç–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
2. –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è DesaySV
3. Yandex Navigator (–µ—Å–ª–∏ —É–¥–∞—Å—Ç—Å—è –∏–∑–≤–ª–µ—á—å)

### –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ:
- `BridgeService.java` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
- `NavigationDataInterceptor.java` - –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
- `NavigationMonitor.java` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
- `SystemSender.java` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º—É

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### ConfigManager –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- `nav_package` - –ø–∞–∫–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `ru.yandex.yandexnavi`)
- `auto_start_navigator` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
- `send_interval_ms` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ `Logger` –∫–ª–∞—Å—Å —Å —Ç–µ–≥–∞–º–∏:
- `BridgeService` - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
- `NavDataInterceptor` - –ø–µ—Ä–µ—Ö–≤–∞—Ç –¥–∞–Ω–Ω—ã—Ö
- `NavigationMonitor` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- `ReflectionHelper` - reflection –æ–ø–µ—Ä–∞—Ü–∏–∏

## –°—Å—ã–ª–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã

- JADX: https://github.com/skylot/jadx
- ADB –∫–æ–º–∞–Ω–¥—ã: `development/–ö–û–ú–ê–ù–î–´_ADB.md`
- –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã: `development/–ù–ê–ô–î–ï–ù–ù–´–ï_–ü–ê–ö–ï–¢–´.md`

